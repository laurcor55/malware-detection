import pandas as pd
import malware_detection_lib as lib

df = lib.load_data()
df_train, df_test, df_val = lib.tri_split(df)
permissions = df.columns.values[:-1]

print('_________________')
print('Data Overview')
df.info()
df.describe()


print('_________________')
print('Overall Permission Count for Result')
print(lib.get_permission_stats_by_result(df))


print('_________________')
print('Permission Frequency for Result')
df_permission_counts = lib.get_permission_counts(df)
print('Top Permissions')
print(df_permission_counts.sort_values('true_permission_count', ascending=False).head(10))

print('Malware Top Permissions')
print(df_permission_counts.sort_values('malware_true_permission_count', ascending=False).head(10))

print('Permissions Increased in Malware Only')
print(df_permission_counts.sort_values('increase_true_count', ascending=False).head(10))